# Регистры бухгалтерии в 1С

## Общие принципы регистров бухгалтерии

Регистры бухгалтерии в 1С - это механизм для хранения и обработки бухгалтерских проводок. Они обеспечивают автоматическое формирование проводок при проведении документов и предоставляют готовые итоги для отчетности.

## Типы регистров бухгалтерии

### 1. Регистры накопления
- **Остатки** - хранят текущие остатки по счетам
- **Обороты** - хранят обороты за периоды
- **Остатки и обороты** - комбинированный тип

### 2. Регистры сведений
- **Детализация** - хранят детальные данные
- **Аналитика** - дополнительные аналитические разрезы

## Структура регистра бухгалтерии

### Измерения (аналитика):
- **Счет** - бухгалтерский счет
- **Субконто1, Субконто2, Субконто3** - аналитические разрезы
- **Организация** - юридическое лицо
- **Период** - временной интервал
- **Валюта** - валюта учета

### Ресурсы:
- **Сумма** - сумма проводки
- **Количество** - количественный учет
- **Курс** - курс валюты
- **СуммаВал** - сумма в валюте

## Настройка регистров бухгалтерии

### Конфигурация в метаданных:
```bsl
// Пример настройки регистра
РегистрБухгалтерии = Метаданные.РегистрыБухгалтерии.ИмяРегистра;

// Измерения
РегистрБухгалтерии.Измерения.Добавить("Счет");
РегистрБухгалтерии.Измерения.Добавить("Субконто1");
РегистрБухгалтерии.Измерения.Добавить("Организация");

// Ресурсы
РегистрБухгалтерии.Ресурсы.Добавить("Сумма");
РегистрБухгалтерии.Ресурсы.Добавить("Количество");
```

### План счетов:
- **Синтетические счета** - основные счета
- **Аналитические счета** - субсчета
- **Валютные счета** - счета в иностранной валюте
- **Количественные счета** - счета с количественным учетом

## Программирование регистров бухгалтерии

### Запись в регистр:
```bsl
// Создание записи регистра
Запись = РегистрыБухгалтерии.ИмяРегистра.СоздатьЗапись();

// Установка измерений
Запись.Счет = ПланыСчетов.Хозрасчетный.Товары;
Запись.Субконто1 = Справочники.Номенклатура.НайтиПоНаименованию("Товар");
Запись.Организация = Справочники.Организации.ОсновнаяОрганизация;

// Установка ресурсов
Запись.Сумма = 1000;
Запись.Количество = 10;

// Вид движения
Запись.ВидДвижения = ВидДвиженияНакопления.Приход;

// Запись
Запись.Записать();
```

### Чтение из регистра:
```bsl
// Получение остатков
Остатки = РегистрыБухгалтерии.ИмяРегистра.Остатки(
    ТекущаяДата(),
    "Счет = &Счет И Организация = &Организация",
    Новый Структура("Счет, Организация", Счет, Организация)
);

// Получение оборотов
Обороты = РегистрыБухгалтерии.ИмяРегистра.Обороты(
    НачалоМесяца(ТекущаяДата()),
    КонецМесяца(ТекущаяДата()),
    "Счет = &Счет",
    Новый Структура("Счет", Счет)
);
```

## Автоматическое формирование проводок

### Обработчики документов:
```bsl
// В модуле документа
Процедура ОбработкаПроведения(Отказ, Режим)
    // Формирование проводок
    Движения.ИмяРегистра.Записывать = Истина;
    
    Для Каждого Строка Из Товары Цикл
        Движение = Движения.ИмяРегистра.Добавить();
        Движение.ВидДвижения = ВидДвиженияНакопления.Приход;
        Движение.Счет = ПланыСчетов.Хозрасчетный.Товары;
        Движение.Субконто1 = Строка.Номенклатура;
        Движение.Сумма = Строка.Сумма;
    КонецЦикла;
КонецПроцедуры
```

### Корреспонденция счетов:
- **Дебет/Кредит** - классическая схема
- **Активные/Пассивные счета** - правила сальдо
- **Сложные проводки** - несколько корреспонденций

## Оптимизация производительности

### Индексы:
- **Составные индексы** - по нескольким измерениям
- **Уникальные индексы** - для предотвращения дублей
- **Частичные индексы** - по условиям

### Кэширование:
- **Кэш остатков** - для быстрого доступа
- **Кэш оборотов** - для отчетности
- **Периодическое обновление** - по расписанию

## Интеграция с отчетностью

### Готовые итоги:
- **Остатки на дату** - мгновенный доступ
- **Обороты за период** - для отчетов
- **Аналитика** - детализация по разрезам

### Специальные регистры:
- **Регистры расчета** - для сложных расчетов
- **Регистры сведений** - для дополнительной аналитики
- **Виртуальные таблицы** - для сложных запросов

## Типовые сценарии использования

### Торговые операции:
```bsl
// Поступление товаров
Движение = Движения.ТоварыНаСкладах.Добавить();
Движение.ВидДвижения = ВидДвиженияНакопления.Приход;
Движение.Счет = ПланыСчетов.Хозрасчетный.Товары;
Движение.Субконто1 = Строка.Номенклатура;
Движение.Субконто2 = Строка.Склад;
Движение.Сумма = Строка.Сумма;
Движение.Количество = Строка.Количество;
```

### Производственные операции:
```bsl
// Выпуск продукции
Движение = Движения.Производство.Добавить();
Движение.ВидДвижения = ВидДвиженияНакопления.Приход;
Движение.Счет = ПланыСчетов.Хозрасчетный.ГотоваяПродукция;
Движение.Субконто1 = Строка.Номенклатура;
Движение.Сумма = Строка.Себестоимость;
```

### Зарплатные операции:
```bsl
// Начисление зарплаты
Движение = Движения.Зарплата.Добавить();
Движение.ВидДвижения = ВидДвиженияНакопления.Приход;
Движение.Счет = ПланыСчетов.Хозрасчетный.РасчетыСПерсоналом;
Движение.Субконто1 = Строка.Сотрудник;
Движение.Сумма = Строка.СуммаНачисления;
```

## Мониторинг и диагностика

### Проверка целостности:
- **Контроль остатков** - отрицательные остатки
- **Проверка корреспонденции** - правильность проводок
- **Анализ производительности** - медленные операции

### Инструменты диагностики:
- **Конфигуратор** - настройка регистров
- **Отладчик** - пошаговое выполнение
- **Профилировщик** - анализ производительности
- **Логи** - запись операций

## Миграция и обновление

### Версионирование:
- **Схемы регистров** - изменения структуры
- **Данные** - миграция существующих записей
- **Настройки** - обновление конфигурации

### Обратная совместимость:
- **Старые форматы** - поддержка legacy
- **Конвертация данных** - автоматическая миграция
- **Документирование** - описание изменений
